#!/usr/bin/env bash
set -eou pipefail

docker build -f "$CG_APP_ROOT/Dockerfile.prebuild" -t backend-prebuild "$PL_MONOREPO_ROOT" \
  --build-arg PYTHON_VER_MAJOR=$CG_PYTHON_VER_MAJOR \
  --build-arg PYTHON_VER_MINOR=$CG_PYTHON_VER_MINOR \
  --build-arg PYTHON_VER_PATCH=$CG_PYTHON_VER_PATCH \
  --build-arg DEBIAN_VER=$CG_DEBIAN_VER
docker tag backend-prebuild shangren.registry.local/backend-prebuild
docker login shangren.registry.local
docker push shangren.registry.local/backend-prebuild
